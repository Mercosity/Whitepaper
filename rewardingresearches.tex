\section{Rewarding Researchers}

Gridcoin does not only want to reward holders of the coin (as in pure Proof of Stake coins such as Peercoin [2]), but wants to reward researchers. Because of this there is an additional reward depending on the amount of research done. This information is read from a superblock. In some blocks, so called superblocks, the majority opinion from the distributed Neural Network, which user has done how much work is also saved as a hash. These blocks are generated once a day. The current amount of research done by each CPID stored in the last superblock can be viewed on [SUPER]. If a node gets chosen and the hash this node contains about the amount of work done by each user is the same as the majority hash stored in the Neural Network, then this node gets to stake the next block and everything starts again. If the hash is not the same as the majority hash, the node gets punished for trying to cheat the system and does not stake, as in any other consensus based cryptocurrency. The actual reward the node gets then depends on the \textit{RAC} (Recently Averaged Credit [22]) for each project for this user as stored in the superblock.\\

To understand \textit{RAC}, we first look at the \textit{cobblestone} [22]. The \textit{cobblestone} is a unit of measure defined as follows: it is 1/200 day (=7 minutes and 12 seconds, 432 seconds) of CPU time on a reference computer that does 1 Gigaflop (= 1 billion floating point operations per second) based on the Whetstone benchmark. A \textit{cobblestone} in other words correspond to 432 seconds * 1 Gigaflop = 432 billion floating point operations.\\

Recently Averaged Credit is computed as follows: the daily average of cobblestones in last week plus half of the daily average of cobblestones during two weeks ago plus fourth of the daily average during three weeks ago and so on.\\ 

We hereby define:
\begin{description}
  \item{$\gamma$} : this is the average \textit{RAC} done by a user on a particular BOINC project \textit{p} since last payment to user \textit{u} identified by \textit{CPID}.
  \item{$\Gamma$} : this is the average \textit{RAC} done by all users partecipating in Gridcoin on a particular BOINC project \textit{p} since last payment to user \textit{u}.
  \item{$\tau$} : this is the time expressed in days since last payment to user \textit{u}.
  \item{$\Theta$} : this is the available gridcoin supply per day assigned to BOINC project \textit{p}
  \item{$G$} : this is the constant number of gridcoins created per day on the gridcoin network. 
  \item{$n$} : this is the number of BOINC projects in the whitelist. Partecipants in whitelisted projects do receive a reward in gridcoins for their computational effort.  
\end{description}

The ratio
\[\gamma/\Gamma\]
is the percentage of work done by user \textit{u} on BOINC project \textit{p} in respect to all other gridcoin users working on project \textit{p}.\\

The amount of coins $\sigma$ for project \textit{p} the user \textit{u} gets, if he was only running project \textit{p}, is computed:
\[ \sigma = (\gamma / \Gamma) \cdot \tau \cdot \Theta \]

As of now the $\Theta$ is the same for each project, so
\[ \Theta = G/n \]

$\gamma$ and $\Gamma$ are calculated so that in case there were several superblocks since the last payment the average RAC of all those superblocks is used.\\

The $researchreward$ for user \textit{u} is then the sum of the rewards for each whitelisted project:

\[ researchreward = \sum_{p=1}^{n} \sigma(p) \]


The $totalreward$  for user \textit{u} is then the reward for the research done by this node plus the reward that any node gets for staking a block, called $inflationreward$ in the next formula:
\[ totalreward = inflationreward +  researchreward \]

The $inflationreward$ depends on the time that passed since the last stake is chosen in a way that it leads to an interest rate of 1.5\% per year.\\

The rewards that contain only $inflationreward$ and no $researchreward$
are often called PoS (Proof of Stake) rewards, whereas the rewards containing $inflationreward$ plus $researchreward$ are called Proof of Research rewards.


\subsection{Gridcoin as TOP 500 Supercomputer}

We saw in the previous chapter that one cobblestone (or one BOINC credit) corresponds to 432 billion floating point operations. We try now to extrapolate the current speed of general BOINC users and the subset of BOINC users who run also the gridcoin client.\\

On \textit{boincstats.com}[24] for August 26, 2017 we read following numbers: on this day BOINC useres produced 3'034'366'125 cobblestones. Gridcoin users produced a subset of that amout: 513'112'244 cobblestones. To convert the cobblestones in billion operations per second, we multiply them first by 432, to get the floating points operations done in one day. We then divide by the number of seconds in one day which is 24 hours at 3600 seconds = 86400 seconds.

\[ gigaflops = (cobblestones \cdot 432)/(24 \cdot 3600) = (cobblestones \cdot 432/86400) = cobblestones/200 \]

Following formula above, we convert the cobblestones for BOINC users and Gridcoin users into billion operations per second:

\begin{itemize}
	\item BOINC users did 3'034'366'125 cobblestones, this is converted to the speed of 15'171'800 gigaflops or 15'171 teraflops or 15.171 petaflops.
	\item The subset of BOINC users who run also gridcoin client did 513'112'244 cobblestones, this is converted to the speed of 2'565'560 gigaflops or 2'565 teraflops or 2.565 petaflops.
	\item The number above teach us that gridcoin users on August 26, 2017 are 2.565/15.171 = 16.9\% of BOINC users
\end{itemize}

We now look at the TOP 500 supercomputer statistics, that it is adjusted every six month. We take for reference the list of June 2017 [25].

\begin{itemize}
    \item BOINC users with 15'171 teraflops are ranked 6th between supercomputers \textit{Sequoia} and \textit{Cori}.
	\item gridcoin users with 2'565 teraflops are ranked 49th between supercomputers \textit{Tianhe-1A} and \textit{cascade}.
\end{itemize}

If we forget for one moment that Bitcoin does not allow flexible computations, but consistently attempts to invert only and always the same hash function. What would be bitcoin ranking in TOP 500 supercomputer list on August 26, 2017? According to [26], bitcoin speed on this day was 6'354'668.57 terahash 80'704'290.84 petaflops or 80'704'290'840 teraflops. From this numbers we understand that calculating one hash costs 12'700 floating point operations. \\

The stated Bitcoin difficulty of 923'233'068'449 (August 26, 2017) which is a number of 40 binary digits (1101011011110100111110101010010110100001) tells us that a hash needs to have the first 40 bits set at zero in order to get the coinbase reward for the block. To date, the coinbase reward is 12.5 bitcoins (TODO: check if difficulty is explained correctly).\\

The fastest supercomputer in TOP 500 list is Sunway TaihuLight of National Supercomputing Center in Wuxi, China with a speed of 125'435.9 teraflops. Bitcoin would be by far the fastet supercomputer in the world and outperform by factor 643'391!

\subsection{Gridcoin Power Consumption estimate}

//TODO: add estimate for BOINC users, Gridcoin and bitcoin. Calculate CO2 impact. 
China	Sunway TaihuLight